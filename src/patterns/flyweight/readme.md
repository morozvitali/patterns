–ø–∞—Ç–µ—Ä–Ω –ø—Ä–æ—î–∫—Ç—É–≤–∞–Ω–Ω—è Flyweight (–õ–µ–≥–∫–æ–≤–∞–≥–æ–≤–∏–∫), —è–∫–∏–π,
–Ω–µ–∑–≤–∞–∂–∞—é—á–∏ –Ω–∞ —Å–≤–æ—é "–ª–µ–≥–∫—ñ—Å—Ç—å", –Ω–µ —Ç–∞–∫–∏–π –≤–∂–µ –π –ø—Ä–æ—Å—Ç–∏–π üòÑ

üß© Flyweight (–õ–µ–≥–∫–æ–≤–∞–≥–æ–≤–∏–∫) ‚Äî —Å—É—Ç—å
–¶–µ —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω–∏–π –ø–∞—Ç–µ—Ä–Ω, —è–∫–∏–π –¥–æ–∑–≤–æ–ª—è—î –∑–º–µ–Ω—à–∏—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –ø–∞–º‚Äô—è—Ç—ñ
—à–ª—è—Ö–æ–º –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –æ–¥–Ω–∞–∫–æ–≤–∏—Ö –æ–±'—î–∫—Ç—ñ–≤.

üîß –ö–æ–ª–∏ –∑–∞—Å—Ç–æ—Å–æ–≤—É–≤–∞—Ç–∏
–Ñ –≤–µ–ª–∏—á–µ–∑–Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –¥—Ä—ñ–±–Ω–∏—Ö –æ–±'—î–∫—Ç—ñ–≤, —è–∫—ñ –ø–æ–≤—Ç–æ—Ä—é—é—Ç—å—Å—è.
–¶—ñ –æ–±'—î–∫—Ç–∏ –∑–∞–π–º–∞—é—Ç—å –±–∞–≥–∞—Ç–æ –ø–∞–º‚Äô—è—Ç—ñ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, —Å–∏–º–≤–æ–ª–∏ –Ω–∞ –µ–∫—Ä–∞–Ω—ñ,
–ø—ñ–∫—Å–µ–ª—ñ, —á–∞—Å—Ç–∏–Ω–∏ HTML-–µ–ª–µ–º–µ–Ω—Ç—ñ–≤).
–ß–∞—Å—Ç–∏–Ω–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó —É –Ω–∏—Ö –æ–¥–Ω–∞–∫–æ–≤–∞ (shared) ‚Äî —ó—ó –º–æ–∂–Ω–∞ –≤–∏–Ω–µ—Å—Ç–∏ –≤ –æ–¥–∏–Ω –µ–∫–∑–µ–º–ø–ª—è—Ä.
–Ü–Ω—à–∞ —á–∞—Å—Ç–∏–Ω–∞ ‚Äî —É–Ω—ñ–∫–∞–ª—å–Ω–∞ (extrinsic) ‚Äî –ø–µ—Ä–µ–¥–∞—î—Ç—å—Å—è –∑–æ–≤–Ω—ñ –ø—ñ–¥ —á–∞—Å –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è.

üì¶ –ü—Ä–∏–∫–ª–∞–¥ –∑ —Ä–µ–∞–ª—å–Ω–æ–≥–æ —Å–≤—ñ—Ç—É
–£—è–≤—ñ–º–æ —Ç–µ–∫—Å—Ç–æ–≤–∏–π —Ä–µ–¥–∞–∫—Ç–æ—Ä, –¥–µ –∫–æ–∂–Ω–∞ –ª—ñ—Ç–µ—Ä–∞ ‚Äî —Ü–µ –æ–±‚Äô—î–∫—Ç.
–Ø–∫—â–æ –≤ —Ç–µ–∫—Å—Ç—ñ —î 100 000 —Å–∏–º–≤–æ–ª—ñ–≤, –∞–ª–µ –ª–∏—à–µ 26 —É–Ω—ñ–∫–∞–ª—å–Ω–∏—Ö –ª—ñ—Ç–µ—Ä (–∞–Ω–≥–ª—ñ–π—Å—å–∫–∏–π –∞–ª—Ñ–∞–≤—ñ—Ç),
—Ç–æ –∑–∞–º—ñ—Å—Ç—å —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è 100 000 –æ–±'—î–∫—Ç—ñ–≤, Flyweight –¥–æ–∑–≤–æ–ª—è—î –º–∞—Ç–∏ 26 "–ª–µ–≥–∫–æ–≤–∞–≥–æ–≤–∏—Ö" –æ–±'—î–∫—Ç—ñ–≤,
—è–∫—ñ —Ä–æ–∑–¥—ñ–ª—è—é—Ç—å –∑–∞–≥–∞–ª—å–Ω—ñ –¥–∞–Ω—ñ ‚Äî –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, —à—Ä–∏—Ñ—Ç, —Å—Ç–∏–ª—å,
–∞ —É–Ω—ñ–∫–∞–ª—å–Ω—ñ –¥–∞–Ω—ñ ‚Äî –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∏ ‚Äî –ø–µ—Ä–µ–¥–∞—é—Ç—å—Å—è –æ–∫—Ä–µ–º–æ.

üèóÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞

1. Flyweight ‚Äî —Å–ø—ñ–ª—å–Ω–∏–π —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –≤—Å—ñ—Ö –ª–µ–≥–∫–æ–≤–∞–≥–æ–≤–∏—Ö –æ–±‚Äô—î–∫—Ç—ñ–≤.
2. ConcreteFlyweight ‚Äî —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—è, —è–∫–∞ –∑–±–µ—Ä—ñ–≥–∞—î –≤–Ω—É—Ç—Ä—ñ—à–Ω—ñ–π (—Å–ø—ñ–ª—å–Ω–∏–π) —Å—Ç–∞–Ω.
3. FlyweightFactory ‚Äî —Ñ–∞–±—Ä–∏–∫–∞, —è–∫–∞ –∫–µ—Ä—É—î –ª–µ–≥–∫–æ–≤–∞–≥–æ–≤–∏–º–∏ –æ–±‚Äô—î–∫—Ç–∞–º–∏. 
–í–∏–¥–∞—î –≤–∂–µ —ñ—Å–Ω—É—é—á–∏–π –∞–±–æ —Å—Ç–≤–æ—Ä—é—î –Ω–æ–≤–∏–π.
4. Client ‚Äî –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î Flyweight, –ø–µ—Ä–µ–¥–∞—é—á–∏ –∑–æ–≤–Ω—ñ—à–Ω—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏.

   üß™ Java-–ø—Ä–∏–∫–ª–∞–¥
// Flyweight
interface Shape {
void draw(int x, int y); // x,y ‚Äî extrinsic state
}

// ConcreteFlyweight
class Circle implements Shape {
private final String color; // intrinsic state

public Circle(String color) {
this.color = color;
}

@Override
public void draw(int x, int y) {
System.out.println("Drawing " + color + " circle at (" + x + ", " + y + ")");
}
}

// FlyweightFactory
class ShapeFactory {
private static final Map<String, Shape> circleMap = new HashMap<>();

public static Shape getCircle(String color) {
return circleMap.computeIfAbsent(color, c -> new Circle(c));
}
}

// Client
public class FlyweightDemo {
public static void main(String[] args) {
for (int i = 0; i < 10; i++) {
Shape circle = ShapeFactory.getCircle("red"); // only one red circle object is created
circle.draw(i, i * 2);
}
}
}

 üîç –£ –ø—Ä–∏–∫–ª–∞–¥—ñ:
color ‚Äî –≤–Ω—É—Ç—Ä—ñ—à–Ω—ñ–π —Å—Ç–∞–Ω (shared),
x, y ‚Äî –∑–æ–≤–Ω—ñ—à–Ω—ñ–π —Å—Ç–∞–Ω (—É–Ω—ñ–∫–∞–ª—å–Ω–∏–π –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è),
ShapeFactory –∑–∞–±–µ–∑–ø–µ—á—É—î –ø–æ–≤—Ç–æ—Ä–Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è.

‚úÖ –ü–µ—Ä–µ–≤–∞–≥–∏
‚ö° –ï–∫–æ–Ω–æ–º—ñ—è –ø–∞–º'—è—Ç—ñ.

üì¶ –ú–µ–Ω—à–µ –æ–±'—î–∫—Ç—ñ–≤ ‚Üí –º–µ–Ω—à–µ —Ç–∏—Å–∫—É –Ω–∞ GC.

üß† –Ø—Å–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–Ω–∏—Ö –µ–ª–µ–º–µ–Ω—Ç—ñ–≤.

‚ùå –ù–µ–¥–æ–ª—ñ–∫–∏
üî© –£—Å–∫–ª–∞–¥–Ω—é—î –ª–æ–≥—ñ–∫—É ‚Äî –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤—ñ–¥–¥—ñ–ª—è—Ç–∏ –≤–Ω—É—Ç—Ä—ñ—à–Ω—ñ–π —ñ –∑–æ–≤–Ω—ñ—à–Ω—ñ–π —Å—Ç–∞–Ω.
üöß –ù–µ –ø—ñ–¥—Ö–æ–¥–∏—Ç—å, —è–∫—â–æ –æ–±‚Äô—î–∫—Ç–∏ —á–∞—Å—Ç–æ –∑–º—ñ–Ω—é—é—Ç—å —Å–≤—ñ–π —Å—Ç–∞–Ω.
üß™ –Ü–Ω–∫–æ–ª–∏ —Å–∫–ª–∞–¥–Ω–æ —Ç–µ—Å—Ç—É–≤–∞—Ç–∏, —è–∫—â–æ —Å—Ç–∞–Ω —Ä–æ–∑–∫–∏–¥–∞–Ω–æ.

üß† –ó–∞–ø–∞–º'—è—Ç–∞–π
Flyweight ‚Äî —Ü–µ —è–∫ —Ä–æ–∑–¥–∞—á–∞ –æ–¥–Ω–æ–≥–æ –≤–µ–ª–æ—Å–∏–ø–µ–¥–∞ —Ä—ñ–∑–Ω–∏–º –¥—ñ—Ç—è–º, –¥–µ –∫–æ–∂–µ–Ω –ø—Ä–∏–Ω–æ—Å–∏—Ç—å —Å–≤—ñ–π —à–æ–ª–æ–º.
–í–µ–ª–æ—Å–∏–ø–µ–¥ ‚Äî —Å–ø—ñ–ª—å–Ω–∏–π, —à–æ–ª–æ–º ‚Äî —ñ–Ω–¥–∏–≤—ñ–¥—É–∞–ª—å–Ω–∏–π.


--------------------------------------------------------------------------------------

üí° –ó–∞—Ä–∞–∑ –∑—Ä–æ–±–∏–º–æ –ø—Ä–∞–∫—Ç–∏—á–Ω—É –∑–∞–¥–∞—á—É –Ω–∞ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—é –ø–∞—Ç–µ—Ä–Ω–∞ Flyweight.
–°—Ü–µ–Ω–∞—Ä—ñ–π –±—É–¥–µ –ø—Ä–æ—Å—Ç–∏–π, –∞–ª–µ —Ä–µ–∞–ª—ñ—Å—Ç–∏—á–Ω–∏–π ‚Äî –¥–ª—è –ø–æ–≤–Ω–æ–≥–æ —Ä–æ–∑—É–º—ñ–Ω–Ω—è.

üß™ –ó–∞–≤–¥–∞–Ω–Ω—è: –õ—ñ—Å —ñ–∑ –¥–µ—Ä–µ–≤–∞–º–∏ üå≥
–£—è–≤—ñ–º–æ, —â–æ –º–∏ –º–∞–ª—é—î–º–æ –ª—ñ—Å. –ö–æ–∂–Ω–µ –¥–µ—Ä–µ–≤–æ –º–∞—î:
—Ç–∏–ø –¥–µ—Ä–µ–≤–∞ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, "–¥—É–±", "–±–µ—Ä–µ–∑–∞", "—Å–æ—Å–Ω–∞") ‚Üí —Ü–µ –≤–Ω—É—Ç—Ä—ñ—à–Ω—ñ–π (shared) —Å—Ç–∞–Ω,
–∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∏ X —Ç–∞ Y ‚Üí —Ü–µ –∑–æ–≤–Ω—ñ—à–Ω—ñ–π (—É–Ω—ñ–∫–∞–ª—å–Ω–∏–π) —Å—Ç–∞–Ω.

üéØ –ù–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ:

–∑–µ–∫–æ–Ω–æ–º–∏—Ç–∏ –ø–∞–º‚Äô—è—Ç—å, —Å—Ç–≤–æ—Ä—é—é—á–∏ –ø–æ –æ–¥–Ω–æ–º—É –æ–±'—î–∫—Ç—É –Ω–∞ –∫–æ–∂–µ–Ω —Ç–∏–ø –¥–µ—Ä–µ–≤–∞,
–∑–±–µ—Ä—ñ–≥–∞—Ç–∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∏ –æ–∫—Ä–µ–º–æ,
–≤—ñ–¥–æ–±—Ä–∞–∂–∞—Ç–∏ –ª—ñ—Å, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ Flyweight.

üîß –ö—Ä–æ–∫–∏ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó
–Ü–Ω—Ç–µ—Ä—Ñ–µ–π—Å Tree
–ö–ª–∞—Å ConcreteTree ‚Äî –∑–±–µ—Ä—ñ–≥–∞—î —Å–ø—ñ–ª—å–Ω—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é (–Ω–∞–∑–≤–∞, —Ç–µ–∫—Å—Ç—É—Ä–∞)
–ö–ª–∞—Å TreeFactory ‚Äî –≤–∏–¥–∞—î Flyweight-–¥–µ—Ä–µ–≤–∞
–ö–ª–∞—Å Forest ‚Äî –º—ñ—Å—Ç–∏—Ç—å —Å–ø–∏—Å–æ–∫ –ø–æ–∑–∏—Ü—ñ–π + –ø–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ Tree

–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü—ñ—è –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

üíª –ü–æ—á–∞—Ç–∫–æ–≤–∏–π –∫–æ–¥

import java.util.*;

// 1. Flyweight —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å
interface Tree {
void display(int x, int y);
}

// 2. ConcreteFlyweight
class ConcreteTree implements Tree {
private final String name;
private final String texture;

public ConcreteTree(String name, String texture) {
        this.name = name;
        this.texture = texture;
    }

@Override
    public void display(int x, int y) {
        System.out.printf("üå≤ %s (—Ç–µ–∫—Å—Ç—É—Ä–∞: %s) ‚Äî –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∏ (%d, %d)%n", name, texture, x, y);
    }
}

// 3. Flyweight Factory
class TreeFactory {
private static final Map<String, Tree> trees = new HashMap<>();

public static Tree getTree(String name, String texture) {
        String key = name + ":" + texture;
        return trees.computeIfAbsent(key, k -> new ConcreteTree(name, texture));
    }

public static int totalTreeTypes() {
        return trees.size();
    }
}

// 4. –ö–ª–∞—Å Forest (Client)
class Forest {
private static class TreePosition {
int x, y;
Tree tree;

TreePosition(int x, int y, Tree tree) {
            this.x = x;
            this.y = y;
            this.tree = tree;
        }
    }

private final List<TreePosition> forest = new ArrayList<>();

public void plantTree(int x, int y, String name, String texture) {
        Tree tree = TreeFactory.getTree(name, texture);
        forest.add(new TreePosition(x, y, tree));
    }

public void displayForest() {
        for (TreePosition position : forest) {
            position.tree.display(position.x, position.y);
        }
    }
}

// 5. –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü—ñ—è
public class FlyweightTreeDemo {
public static void main(String[] args) {
Forest forest = new Forest();

// –ü–æ—Å–∞–¥–∏–º–æ –±–∞–≥–∞—Ç–æ –¥–µ—Ä–µ–≤ –∑ –ø–æ–≤—Ç–æ—Ä—é–≤–∞–Ω–∏–º–∏ —Ç–∏–ø–∞–º–∏
        forest.plantTree(1, 2, "–°–æ—Å–Ω–∞", "–∑–µ–ª–µ–Ω–∞ —Ç–µ–∫—Å—Ç—É—Ä–∞");
        forest.plantTree(2, 3, "–°–æ—Å–Ω–∞", "–∑–µ–ª–µ–Ω–∞ —Ç–µ–∫—Å—Ç—É—Ä–∞");
        forest.plantTree(5, 1, "–ë–µ—Ä–µ–∑–∞", "–±—ñ–ª–∞ —Ç–µ–∫—Å—Ç—É—Ä–∞");
        forest.plantTree(7, 4, "–°–æ—Å–Ω–∞", "–∑–µ–ª–µ–Ω–∞ —Ç–µ–∫—Å—Ç—É—Ä–∞");
        forest.plantTree(9, 6, "–î—É–±", "–∫–æ—Ä–∏—á–Ω–µ–≤–∞ —Ç–µ–∫—Å—Ç—É—Ä–∞");

System.out.println("=== –í—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –ª—ñ—Å—É ===");
        forest.displayForest();

System.out.printf("üì¶ –í—Å—å–æ–≥–æ —É–Ω—ñ–∫–∞–ª—å–Ω–∏—Ö —Ç–∏–ø—ñ–≤ –¥–µ—Ä–µ–≤: %d%n", TreeFactory.totalTreeTypes());
    }
}
üß† –©–æ —Ç–∏ –æ—Ç—Ä–∏–º–∞—î—à:
—Ç—ñ–ª—å–∫–∏ 3 —Ä–µ–∞–ª—å–Ω—ñ –æ–±'—î–∫—Ç–∏ Tree (1 –¥–ª—è "–°–æ—Å–Ω–∞", 1 –¥–ª—è "–ë–µ—Ä–µ–∑–∞", 1 –¥–ª—è "–î—É–±"),
—Å–∫—ñ–ª—å–∫–∏ –∑–∞–≤–≥–æ–¥–Ω–æ –¥–µ—Ä–µ–≤ —ñ–∑ —Ä—ñ–∑–Ω–∏–º–∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏ ‚Äî –µ–∫–æ–Ω–æ–º—ñ—è –ø–∞–º‚Äô—è—Ç—ñ!

üîç –©–æ –º–æ–∂–Ω–∞ –¥–æ–¥–∞—Ç–∏:
–ó—Ä–æ–±–∏—Ç–∏ –≥—Ä–∞—Ñ—ñ—á–Ω—É —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—é (JavaFX)
–ó–±–µ—Ä—ñ–≥–∞—Ç–∏ —â–µ –±—ñ–ª—å—à–µ —Å–ø—ñ–ª—å–Ω–æ–≥–æ —Å—Ç–∞–Ω—É (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, —Ñ–æ—Ä–º–∞ –ª–∏—Å—Ç—è)
–ü–æ—Ä–∞—Ö—É–≤–∞—Ç–∏ —Å–∫—ñ–ª—å–∫–∏ —Ä–µ–∞–ª—å–Ω–æ –∑–µ–∫–æ–Ω–æ–º–ª–µ–Ω–æ –æ–±‚Äô—î–∫—Ç—ñ–≤

https://chatgpt.com/c/6853f69b-88b4-8009-ac0f-e8a0771c6ef2