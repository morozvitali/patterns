–¢–µ–æ—Ä—ñ—è: Singleton Pattern
üîπ –©–æ —Ç–∞–∫–µ Singleton?
Singleton ‚Äî —Ü–µ –ø–∞—Ç–µ—Ä–Ω –ø—Ä–æ—î–∫—Ç—É–≤–∞–Ω–Ω—è, —è–∫–∏–π –≥–∞—Ä–∞–Ω—Ç—É—î,
—â–æ –∫–ª–∞—Å –º–∞—î —Ç—ñ–ª—å–∫–∏ –æ–¥–∏–Ω –µ–∫–∑–µ–º–ø–ª—è—Ä,
—ñ –Ω–∞–¥–∞—î –≥–ª–æ–±–∞–ª—å–Ω—É —Ç–æ—á–∫—É –¥–æ—Å—Ç—É–ø—É –¥–æ –Ω—å–æ–≥–æ.

üîß –ù–∞–≤—ñ—â–æ –≤—ñ–Ω –ø–æ—Ç—Ä—ñ–±–µ–Ω?
–ö–æ–ª–∏ —Ç—Ä–µ–±–∞ —Ü–µ–Ω—Ç—Ä–∞–ª—ñ–∑–æ–≤–∞–Ω–æ –∫–µ—Ä—É–≤–∞—Ç–∏ —á–∏–º–æ—Å—å ‚Äî –Ω–∞–ø—Ä–∏–∫–ª–∞–¥:

–ª–æ–≥—É–≤–∞–Ω–Ω—è (Logger)
–∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è (ConfigManager)
–∑‚Äô—î–¥–Ω–∞–Ω–Ω—è –∑ –±–∞–∑–æ—é (DatabaseConnection)
–∫–µ—à (CacheManager)

üì¶ –ü–µ—Ä–µ–≤–∞–≥–∏:
‚ùå –ù—ñ—Ö—Ç–æ –Ω–µ —Å—Ç–≤–æ—Ä–∏—Ç—å –∑–∞–π–≤–∏–π –æ–±‚Äô—î–∫—Ç
‚úÖ –ú–µ–Ω—à–µ –ø–∞–º‚Äô—è—Ç—ñ
‚úÖ –¶–µ–Ω—Ç—Ä–∞–ª—ñ–∑–æ–≤–∞–Ω–∏–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ –ø–æ–≤–µ–¥—ñ–Ω–∫–æ—é

‚ö†Ô∏è –ù–µ–¥–æ–ª—ñ–∫–∏:
–Ø–∫—â–æ –∑–ª–æ–≤–∂–∏–≤–∞—Ç–∏ ‚Äî –º–æ–∂–µ —Å—Ç–∞—Ç–∏ –≥–ª–æ–±–∞–ª—å–Ω–æ—é –∑–º—ñ–Ω–Ω–æ—é (–ø–æ–≥–∞–Ω–∏–π —Å—Ç–∏–ª—å)
–£ –±–∞–≥–∞—Ç–æ–ø–æ—Ç–æ–∫–æ–≤–æ—Å—Ç—ñ –ø–æ—Ç—Ä–µ–±—É—î –∑–∞—Ö–∏—Å—Ç—É

‚úÖ –ü—Ä–æ—Å—Ç–∏–π –ø—Ä–∏–∫–ª–∞–¥ (Java)
public class Logger {

    // –ø—Ä–∏–≤–∞—Ç–Ω–µ —Å—Ç–∞—Ç–∏—á–Ω–µ –ø–æ–ª–µ –¥–ª—è –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è —î–¥–∏–Ω–æ–≥–æ –µ–∫–∑–µ–º–ø–ª—è—Ä—É
    private static Logger instance;

    // –ø—Ä–∏–≤–∞—Ç–Ω–∏–π –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä ‚Äî –Ω–µ –¥–∞—î —Å—Ç–≤–æ—Ä–∏—Ç–∏ –æ–±‚Äô—î–∫—Ç –∑–∑–æ–≤–Ω—ñ
    private Logger() {
        System.out.println("Logger —Å—Ç–≤–æ—Ä–µ–Ω–æ");
    }

    // –ø—É–±–ª—ñ—á–Ω–∏–π –º–µ—Ç–æ–¥ –¥–æ—Å—Ç—É–ø—É –¥–æ —î–¥–∏–Ω–æ–≥–æ –µ–∫–∑–µ–º–ø–ª—è—Ä–∞
    public static Logger getInstance() {
        if (instance == null) {
            instance = new Logger(); // —Å—Ç–≤–æ—Ä—é—î—Ç—å—Å—è –ª–∏—à–µ –æ–¥–∏–Ω —Ä–∞–∑
        }
        return instance;
    }

    // –º–µ—Ç–æ–¥ –ª–æ–≥—É–≤–∞–Ω–Ω—è
    public void log(String message) {
        System.out.println("[LOG] " + message);
    }
}
üß™ –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è:

public class Main {
public static void main(String[] args) {
Logger logger1 = Logger.getInstance();
Logger logger2 = Logger.getInstance();

        logger1.log("–ü—Ä–æ–≥—Ä–∞–º–∞ —Å—Ç–∞—Ä—Ç—É–≤–∞–ª–∞");
        logger2.log("–¶–µ —Ç–æ–π —Å–∞–º–∏–π –ª–æ–≥–µ—Ä? " + (logger1 == logger2)); // true
    }
}
üîç –†–µ–∑—É–ª—å—Ç–∞—Ç:

csharp
Copy
Edit
Logger —Å—Ç–≤–æ—Ä–µ–Ω–æ
[LOG] –ü—Ä–æ–≥—Ä–∞–º–∞ —Å—Ç–∞—Ä—Ç—É–≤–∞–ª–∞
[LOG] –¶–µ —Ç–æ–π —Å–∞–º–∏–π –ª–æ–≥–µ—Ä? true

üí° –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ñ –≤–∞—Ä—ñ–∞–Ω—Ç–∏ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó:
–ó –ø–æ—Ç–æ–∫–æ–±–µ–∑–ø–µ–∫–æ—é (synchronized)
–ó enum (–Ω–∞–π–±–µ–∑–ø–µ—á–Ω—ñ—à–∏–π –≤–∞—Ä—ñ–∞–Ω—Ç —É Java)
–ß–µ—Ä–µ–∑ static final –ø–æ–ª–µ (—Ä–∞–Ω–Ω—è —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è)

-------------------------------var-2------------------------------------

Singleton ‚Äî —Ü–µ –æ–¥–∏–Ω —ñ–∑ –Ω–∞–π–≤—ñ–¥–æ–º—ñ—à–∏—Ö —ñ –Ω–∞–π–ø—Ä–æ—Å—Ç—ñ—à–∏—Ö –ø–∞—Ç–µ—Ä–Ω—ñ–≤ –ø—Ä–æ—î–∫—Ç—É–≤–∞–Ω–Ω—è, —è–∫–∏–π –≥–∞—Ä–∞–Ω—Ç—É—î, —â–æ —É –∫–ª–∞—Å—É –±—É–¥–µ –ª–∏—à–µ –æ–¥–∏–Ω –µ–∫–∑–µ–º–ø–ª—è—Ä, —ñ –Ω–∞–¥–∞—î –≥–ª–æ–±–∞–ª—å–Ω—É —Ç–æ—á–∫—É –¥–æ—Å—Ç—É–ø—É –¥–æ –Ω—å–æ–≥–æ.

üîπ –°—É—Ç—å Singleton
–û–¥–∏–Ω –æ–±'—î–∫—Ç –Ω–∞ –≤–µ—Å—å –¥–æ–¥–∞—Ç–æ–∫.

–ö–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è–º –æ–±'—î–∫—Ç–∞.

–ß–∞—Å—Ç–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ–π, –ª–æ–≥—É–≤–∞–Ω–Ω—è, –ø—É–ª—ñ–≤ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ –ë–î —Ç–æ—â–æ.

üîß –ü—Ä–æ—Å—Ç–∏–π –ø—Ä–∏–∫–ª–∞–¥ (–ª–µ–¥–∞—á–∞ —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è, –Ω–µ–ø–æ—Ç–æ–∫–æ–±–µ–∑–ø–µ—á–Ω–∞):

public class Singleton {
private static Singleton instance;

    // –ü—Ä–∏–≤–∞—Ç–Ω–∏–π –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä
    private Singleton() {}

    // –ü—É–±–ª—ñ—á–Ω–∏–π –º–µ—Ç–æ–¥ –¥–æ—Å—Ç—É–ø—É
    public static Singleton getInstance() {
        if (instance == null) {
            instance = new Singleton(); // —Å—Ç–≤–æ—Ä—é—î—Ç—å—Å—è —Ç—ñ–ª—å–∫–∏ –æ–¥–∏–Ω —Ä–∞–∑
        }
        return instance;
    }
}
üîß –ü–æ—Ç–æ–∫–æ–±–µ–∑–ø–µ—á–Ω–∞ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—è (—Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–æ–≤–∞–Ω–∏–π –¥–æ—Å—Ç—É–ø):

public class Singleton {
private static Singleton instance;

    private Singleton() {}

    public static synchronized Singleton getInstance() {
        if (instance == null) {
            instance = new Singleton();
        }
        return instance;
    }
}
üîß –ö—Ä–∞—â–∏–π —Å–ø–æ—Å—ñ–± ‚Äî "Double-checked locking":

public class Singleton {
private static volatile Singleton instance;

    private Singleton() {}

    public static Singleton getInstance() {
        if (instance == null) { // –ø–µ—Ä—à–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞
            synchronized (Singleton.class) {
                if (instance == null) { // –¥—Ä—É–≥–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞
                    instance = new Singleton();
                }
            }
        }
        return instance;
    }
}
üîß –©–µ –∫—Ä–∞—â–∏–π –≤–∞—Ä—ñ–∞–Ω—Ç ‚Äî –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Å—Ç–∞—Ç–∏—á–Ω–æ–≥–æ –±–ª–æ–∫—É:

public class Singleton {
private static final Singleton instance = new Singleton();

    private Singleton() {}

    public static Singleton getInstance() {
        return instance;
    }
}
üîß –ù–∞–π–∫—Ä–∞—â–∏–π —ñ —Å—É—á–∞—Å–Ω–∏–π —Å–ø–æ—Å—ñ–± ‚Äî —á–µ—Ä–µ–∑ Enum (–ø–æ—Ç–æ–∫–æ–±–µ–∑–ø–µ—á–Ω–∏–π, —Å–µ—Ä—ñ–∞–ª—ñ–∑–æ–≤–∞–Ω–∏–π, –∑–∞—Ö–∏—â–µ–Ω–∏–π –≤—ñ–¥ reflection):

public enum Singleton {
INSTANCE;

    public void doSomething() {
        System.out.println("Doing something...");
    }
}
üîç –î–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è Singleton:
Runtime.getRuntime() ‚Äî Java API

Logger.getLogger(...) ‚Äî –ª–æ–≥–µ—Ä–∏

Spring Bean –∑ @Scope("singleton")

‚ùó –ù–µ–¥–æ–ª—ñ–∫–∏ Singleton:
–ú–æ–∂–µ –ø–æ—Ä—É—à—É–≤–∞—Ç–∏ SRP (Single Responsibility Principle), —è–∫—â–æ –º–∞—î –±–∞–≥–∞—Ç–æ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞–ª—å–Ω–æ—Å—Ç–µ–π.

–£—Å–∫–ª–∞–¥–Ω—é—î —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è (–æ—Å–æ–±–ª–∏–≤–æ, —è–∫—â–æ –≤–∞–∂–∫–æ –∑–∞–º—ñ–Ω–∏—Ç–∏ –Ω–∞ mock).

–ú–æ–∂–µ –≤–∏–∫–ª–∏–∫–∞—Ç–∏ –ø—Ä–æ–±–ª–µ–º–∏ –∑ –±–∞–≥–∞—Ç–æ–ø–æ—Ç–æ—á–Ω—ñ—Å—Ç—é, —è–∫—â–æ —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–∏–π –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ.

