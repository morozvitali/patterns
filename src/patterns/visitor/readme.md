–ø–∞—Ç–µ—Ä–Ω Visitor (–í—ñ–¥–≤—ñ–¥—É–≤–∞—á): —Ü–µ –æ–¥–∏–Ω —ñ–∑ –ø–æ–≤–µ–¥—ñ–Ω–∫–æ–≤–∏—Ö –ø–∞—Ç–µ—Ä–Ω—ñ–≤ –ø—Ä–æ—î–∫—Ç—É–≤–∞–Ω–Ω—è, 
—è–∫–∏–π –¥–æ–∑–≤–æ–ª—è—î –¥–æ–¥–∞–≤–∞—Ç–∏ –Ω–æ–≤—ñ –æ–ø–µ—Ä–∞—Ü—ñ—ó –¥–æ –æ–±‚Äô—î–∫—Ç—ñ–≤ –±–µ–∑ –∑–º—ñ–Ω–∏ —Å–∞–º–∏—Ö –æ–±‚Äô—î–∫—Ç—ñ–≤. 
–ô–æ–≥–æ —á–∞—Å—Ç–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å, –∫–æ–ª–∏ —î –±–∞–≥–∞—Ç–æ —Ä—ñ–∑–Ω–∏—Ö —Ç–∏–ø—ñ–≤ –æ–±'—î–∫—Ç—ñ–≤, –¥–æ —è–∫–∏—Ö –ø–æ—Ç—Ä—ñ–±–Ω–æ 
–∑–∞—Å—Ç–æ—Å–æ–≤—É–≤–∞—Ç–∏ —Ä—ñ–∑–Ω—É –ø–æ–≤–µ–¥—ñ–Ω–∫—É, –∞–ª–µ —Ü—ñ —Ç–∏–ø–∏ –≤–∂–µ –Ω–µ –º–æ–∂–Ω–∞ –∞–±–æ –Ω–µ –∑—Ä—É—á–Ω–æ –∑–º—ñ–Ω—é–≤–∞—Ç–∏ –Ω–∞–ø—Ä—è–º—É.

üîç –û—Å–Ω–æ–≤–Ω–∞ —ñ–¥–µ—è
–í–∏—Ç—è–≥—É—î–º–æ –æ–ø–µ—Ä–∞—Ü—ñ—ó, —è–∫—ñ –º–∞—é—Ç—å –±—É—Ç–∏ –≤–∏–∫–æ–Ω–∞–Ω—ñ –Ω–∞–¥ —Ä—ñ–∑–Ω–∏–º–∏ –æ–±‚Äô—î–∫—Ç–∞–º–∏, –≤ –æ–∫—Ä–µ–º–∏–π "–≤—ñ–¥–≤—ñ–¥—É–≤–∞—á" (visitor). 
–ó–∞–º—ñ—Å—Ç—å —Ç–æ–≥–æ, —â–æ–± —Ä–µ–∞–ª—ñ–∑–æ–≤—É–≤–∞—Ç–∏ —Ü—ñ –º–µ—Ç–æ–¥–∏ –≤ –∫–æ–∂–Ω–æ–º—É –∫–ª–∞—Å—ñ, –æ–±‚Äô—î–∫—Ç–∏ –ø–µ—Ä–µ–¥–∞—é—Ç—å —Å–µ–±–µ —è–∫ –ø–∞—Ä–∞–º–µ—Ç—Ä —É –º–µ—Ç–æ–¥–∏ –≤—ñ–¥–≤—ñ–¥—É–≤–∞—á–∞.

üìå –£—á–∞—Å–Ω–∏–∫–∏ –ø–∞—Ç–µ—Ä–Ω—É
–†–æ–ª—å	                        –û–ø–∏—Å
Visitor	                    –Ü–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∞–±–æ –∞–±—Å—Ç—Ä–∞–∫—Ç–Ω–∏–π –∫–ª–∞—Å –∑ –º–µ—Ç–æ–¥–∞–º–∏ visit() –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ —Ç–∏–ø—É –æ–±'—î–∫—Ç–∞
ConcreteVisitor	            –ö–æ–Ω–∫—Ä–µ—Ç–Ω–∞ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—è, —è–∫–∞ –≤–∏–∫–æ–Ω—É—î –æ–ø–µ—Ä–∞—Ü—ñ—ó –Ω–∞–¥ –µ–ª–µ–º–µ–Ω—Ç–∞–º–∏
Element	                    –Ü–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∞–±–æ –∞–±—Å—Ç—Ä–∞–∫—Ç–Ω–∏–π –∫–ª–∞—Å, —è–∫–∏–π –º–∞—î –º–µ—Ç–æ–¥ accept(Visitor visitor)
ConcreteElement	            –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ñ –∫–ª–∞—Å–∏, —è–∫—ñ —Ä–µ–∞–ª—ñ–∑—É—é—Ç—å –º–µ—Ç–æ–¥ accept() ‚Äî –≤–∏–∫–ª–∏–∫–∞—é—Ç—å visitor.visit(this)

üß† –ö–æ–ª–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ Visitor:
–ö–æ–ª–∏ –Ω–∞–¥ –æ–±'—î–∫—Ç–∞–º–∏ —ñ—î—Ä–∞—Ä—Ö—ñ—ó –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ —Ä—ñ–∑–Ω—ñ –æ–ø–µ—Ä–∞—Ü—ñ—ó, –∞–ª–µ —Ç–∏ –Ω–µ —Ö–æ—á–µ—à –∑–º—ñ–Ω—é–≤–∞—Ç–∏ —ó—Ö–Ω—ñ–π –∫–æ–¥.
–ö–æ–ª–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ–±'—î–∫—Ç—ñ–≤ –Ω–µ –∑–º—ñ–Ω—é—î—Ç—å—Å—è —á–∞—Å—Ç–æ, –∞–ª–µ –ø–æ–≤–µ–¥—ñ–Ω–∫–∞ –∑–º—ñ–Ω—é—î—Ç—å—Å—è —á–∞—Å—Ç–æ.
–ù–∞–ø—Ä–∏–∫–ª–∞–¥, –ø—Ä–∏ –ø–æ–±—É–¥–æ–≤—ñ AST (abstract syntax tree) –≤ –∫–æ–º–ø—ñ–ª—è—Ç–æ—Ä–∞—Ö, –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞—Ö –∫–æ–¥—É, –∑–≤—ñ—Ç–∞—Ö, –∞–Ω–∞–ª—ñ–∑–∞—Ç–æ—Ä–∞—Ö.

‚úÖ –ü—Ä–∏–∫–ª–∞–¥
–£—è–≤—ñ–º–æ, —â–æ —î —Ñ—ñ–≥—É—Ä–∏: Circle, Rectangle, —ñ —Ç–∏ —Ö–æ—á–µ—à –∑–∞—Å—Ç–æ—Å—É–≤–∞—Ç–∏ —Ä—ñ–∑–Ω—ñ –æ–ø–µ—Ä–∞—Ü—ñ—ó: 
draw(), calculateArea(), exportToJson() ‚Äî –Ω–µ –∑–º—ñ–Ω—é—é—á–∏ –∫–ª–∞—Å–∏ —Ñ—ñ–≥—É—Ä.

üîß 1. –Ü–Ω—Ç–µ—Ä—Ñ–µ–π—Å Element:

    interface Shape {
    void accept(ShapeVisitor visitor);
    }

üîß 2. –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ñ —Ñ—ñ–≥—É—Ä–∏:

    class Circle implements Shape {
    double radius = 5;

    @Override
    public void accept(ShapeVisitor visitor) {
        visitor.visit(this); // –ø–µ—Ä–µ–¥–∞—î–º–æ —Å–µ–±–µ
    }
    }
    
    class Rectangle implements Shape {
    double width = 10, height = 4;

    @Override
    public void accept(ShapeVisitor visitor) {
        visitor.visit(this);
    }
}
üîß 3. –Ü–Ω—Ç–µ—Ä—Ñ–µ–π—Å –≤—ñ–¥–≤—ñ–¥—É–≤–∞—á–∞:

    interface ShapeVisitor {
    void visit(Circle c);
    void visit(Rectangle r);
}
üîß 4. –†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è –æ–ø–µ—Ä–∞—Ü—ñ—ó:

    class AreaCalculator implements ShapeVisitor {
    @Override
    public void visit(Circle c) {
    double area = Math.PI * c.radius * c.radius;
    System.out.println("Circle area: " + area);
    }

    @Override
    public void visit(Rectangle r) {
        double area = r.width * r.height;
        System.out.println("Rectangle area: " + area);
    }
    }

üîß 5. –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è:

    public class Main {
    public static void main(String[] args) {
    List<Shape> shapes = List.of(new Circle(), new Rectangle());
    ShapeVisitor areaCalculator = new AreaCalculator();

        for (Shape shape : shapes) {
            shape.accept(areaCalculator);
        }
    }
    }
ü™ì –ú—ñ–Ω—É—Å–∏ –ø–∞—Ç–µ—Ä–Ω—É Visitor
–ü–æ—Ä—É—à—É—î –ø—Ä–∏–Ω—Ü–∏–ø –≤—ñ–¥–∫—Ä–∏—Ç–æ—Å—Ç—ñ/–∑–∞–∫—Ä–∏—Ç–æ—Å—Ç—ñ –¥–ª—è –µ–ª–µ–º–µ–Ω—Ç—ñ–≤: 
—è–∫—â–æ –¥–æ–¥–∞—î—Ç—å—Å—è –Ω–æ–≤–∏–π —Ç–∏–ø –µ–ª–µ–º–µ–Ω—Ç–∞ ‚Äî —Ç—Ä–µ–±–∞ –∑–º—ñ–Ω—é–≤–∞—Ç–∏ –≤—Å—ñ –≤—ñ–¥–≤—ñ–¥—É–≤–∞—á—ñ.

–¢—Ä–æ—Ö–∏ —Å–∫–ª–∞–¥–Ω—ñ—à–∏–π –∫–æ–¥ ‚Äî –æ—Å–æ–±–ª–∏–≤–æ —è–∫—â–æ –µ–ª–µ–º–µ–Ω—Ç—ñ–≤ –±–∞–≥–∞—Ç–æ.

üéØ –í–∏—Å–Ω–æ–≤–æ–∫
Visitor ‚Äî —Ü–µ:

–°–ø–æ—Å—ñ–± –≤—ñ–¥–æ–∫—Ä–µ–º–∏—Ç–∏ –ª–æ–≥—ñ–∫—É –æ–±—Ä–æ–±–∫–∏ –≤—ñ–¥ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ –æ–±‚Äô—î–∫—Ç—ñ–≤.
–ü–æ—Ç—É–∂–Ω–∏–π —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç —É –≤–∏–ø–∞–¥–∫–∞—Ö, –¥–µ –ø–æ—Ç—Ä—ñ–±–Ω—ñ —Ä—ñ–∑–Ω—ñ –æ–ø–µ—Ä–∞—Ü—ñ—ó –Ω–∞–¥ –Ω–µ–∑–º—ñ–Ω–Ω–∏–º–∏ –∫–ª–∞—Å–∞–º–∏.
–î–æ–±—Ä–µ –ø—Ä–∞—Ü—é—î –∑ –¥–µ—Ä–µ–≤–æ–ø–æ–¥—ñ–±–Ω–∏–º–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞–º–∏, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, AST, XML-–¥–µ—Ä–µ–≤–∞–º–∏ —Ç–æ—â–æ.
–Ø–∫—â–æ —Ö–æ—á–µ—à, –º–æ–∂—É –∑—Ä–æ–±–∏—Ç–∏ —â–µ –ø—Ä–∏–∫–ª–∞–¥–∏ ‚Äî –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –∑ –µ–∫—Å–ø–æ—Ä—Ç–µ—Ä–æ–º —É JSON –∞–±–æ XML, 
–∞–±–æ –≤–∞—Ä—ñ–∞–Ω—Ç, –¥–µ –æ–¥–∏–Ω –≤—ñ–¥–≤—ñ–¥—É–≤–∞—á –∑–±–∏—Ä–∞—î —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É, –∞ —ñ–Ω—à–∏–π –¥—Ä—É–∫—É—î —Ä–µ–∑—É–ª—å—Ç–∞—Ç. 

-----------------------------------------------------------------------------

–°—É–ø–µ—Ä! –ü–æ—á–Ω–µ–º–æ –∑ –ø—Ä–æ—Å—Ç–æ–≥–æ —ñ –ø–æ—Å—Ç—É–ø–æ–≤–æ —É—Å–∫–ª–∞–¥–Ω–∏–º–æ üí°
–û—Å—å –ø–ª–∞–Ω:

üéì –í–ø—Ä–∞–≤–∞ 1. –ü–æ–±—É–¥—É–π —Å–∏—Å—Ç–µ–º—É —Ñ—ñ–≥—É—Ä —ñ –¥–æ–¥–∞–π 2 –≤—ñ–¥–≤—ñ–¥—É–≤–∞—á—ñ
–ú–µ—Ç–∞: –∑–∞—Å–≤–æ—ó—Ç–∏, —è–∫ –≤—ñ–¥–≤—ñ–¥—É–≤–∞—á –≤–∏–∫–æ–Ω—É—î —Ä—ñ–∑–Ω—É –ø–æ–≤–µ–¥—ñ–Ω–∫—É –Ω–∞–¥ –æ–¥–Ω–∏–º–∏ –π —Ç–∏–º–∏ —Å–∞–º–∏–º–∏ –∫–ª–∞—Å–∞–º–∏.

üìã –£–º–æ–≤–∞:
–Ñ 2 —Ç–∏–ø–∏ —Ñ—ñ–≥—É—Ä ‚Äî Circle, Rectangle.
–¢–≤–æ—è –∑–∞–¥–∞—á–∞:

–°—Ç–≤–æ—Ä–∏—Ç–∏ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å Shape –∑ –º–µ—Ç–æ–¥–æ–º accept(ShapeVisitor visitor).
–†–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ 2 –∫–ª–∞—Å–∏: Circle(radius) —ñ Rectangle(width, height).
–°—Ç–≤–æ—Ä–∏—Ç–∏ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å ShapeVisitor –∑ –º–µ—Ç–æ–¥–∞–º–∏ visit(Circle) —ñ visit(Rectangle).
–°—Ç–≤–æ—Ä–∏—Ç–∏ –¥–≤–∞ –≤—ñ–¥–≤—ñ–¥—É–≤–∞—á—ñ:
AreaCalculator ‚Äî –æ–±—á–∏—Å–ª—é—î –ø–ª–æ—â—É
ShapePrinter ‚Äî –≤–∏–≤–æ–¥–∏—Ç—å —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ —Ñ—ñ–≥—É—Ä—É

üß† –ü—ñ–¥–∫–∞–∑–∫–∏:
–î–ª—è –æ–±—á–∏—Å–ª–µ–Ω–Ω—è –ø–ª–æ—â—ñ:

Circle: œÄ * r¬≤

Rectangle: width * height

–£ ShapePrinter –ø—Ä–æ—Å—Ç–æ –¥—Ä—É–∫—É–π Printing: Circle(radius=5) –∞–±–æ Printing: Rectangle(w=10, h=4)

–î–ª—è –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è —Ñ—ñ–≥—É—Ä –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–π:

    List<Shape> shapes = List.of(new Circle(5), new Rectangle(10, 4));
    üîß –ü–æ—á–∞—Ç–∫–æ–≤–∏–π —à–∞–±–ª–æ–Ω (—Ç–∏ –∑–∞–ø–æ–≤–Ω–∏—à —Å–∞–º–æ—Å—Ç—ñ–π–Ω–æ):

    interface Shape {
    void accept(ShapeVisitor visitor);
    }
    
    class Circle implements Shape {
    double radius;

    Circle(double radius) { this.radius = radius; }

    @Override
    public void accept(ShapeVisitor visitor) {
        // ?
    }
    }

    class Rectangle implements Shape {
    double width, height;

    Rectangle(double width, double height) {
        this.width = width;
        this.height = height;
    }

    @Override
    public void accept(ShapeVisitor visitor) {
        // ?
    }
    }   
    
    interface ShapeVisitor {
    void visit(Circle c);
    void visit(Rectangle r);
    }

    // TODO: —Ä–µ–∞–ª—ñ–∑—É–π —Ü—ñ –∫–ª–∞—Å–∏:
    class AreaCalculator implements ShapeVisitor {
    @Override
    public void visit(Circle c) {
    // –ü–ª–æ—â–∞ –∫—Ä—É–≥–∞
    }

    @Override
    public void visit(Rectangle r) {
        // –ü–ª–æ—â–∞ –ø—Ä—è–º–æ–∫—É—Ç–Ω–∏–∫–∞
    }
}

    class ShapePrinter implements ShapeVisitor {
    @Override
    public void visit(Circle c) {
    // –í–∏–≤—ñ–¥ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó
    }

    @Override
    public void visit(Rectangle r) {
        // –í–∏–≤—ñ–¥ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó
    }
    }

    public class Main {
    public static void main(String[] args) {
    List<Shape> shapes = List.of(
    new Circle(5),
    new Rectangle(10, 4)
    );

        ShapeVisitor areaVisitor = new AreaCalculator();
        ShapeVisitor printVisitor = new ShapePrinter();

        for (Shape s : shapes) {
            s.accept(areaVisitor);
        }

        for (Shape s : shapes) {
            s.accept(printVisitor);
        }
    }
    }

üì¶ –û—á—ñ–∫—É–≤–∞–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:

Circle area: 78.54
Rectangle area: 40.00

Printing: Circle(radius=5.0)
Printing: Rectangle(width=10.0, height=4.0)
üîÅ –ù–∞—Å—Ç—É–ø–Ω—ñ –≤–ø—Ä–∞–≤–∏ (—è–∫—â–æ —Ç–æ–±—ñ –∑–∞–π–¥–µ):
–í–ø—Ä–∞–≤–∞ 2: Visitor –¥–ª—è –µ–∫—Å–ø–æ—Ä—Ç—É —É JSON/XML
–í–ø—Ä–∞–≤–∞ 3: Visitor, —è–∫–∏–π –∑–±–∏—Ä–∞—î —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ –∫—ñ–ª—å–∫–æ—Å—Ç—ñ —Ñ—ñ–≥—É—Ä –∫–æ–∂–Ω–æ–≥–æ —Ç–∏–ø—É
–í–ø—Ä–∞–≤–∞ 4: Visitor –∑ –ª–æ–≥—ñ–∫–æ—é, —â–æ –≤ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ –≤—ñ–¥ —É–º–æ–≤ –≤–∏–¥–∞–ª—è—î –∞–±–æ –∑–º—ñ–Ω—é—î —Ñ—ñ–≥—É—Ä–∏

üîß –ì–æ—Ç–æ–≤–∏–π —Ä–æ–∑–≤‚Äô—è–∑–∞—Ç–∏ —Ü—é –ø–µ—Ä—à—É –∑–∞–¥–∞—á—É —Å–∞–º–æ—Å—Ç—ñ–π–Ω–æ, –∞ —è –ø–µ—Ä–µ–≤—ñ—Ä—é? 
–ß–∏ –∑—Ä–∞–∑—É –ø–æ–∫–∞–∑–∞—Ç–∏ –ø–æ–≤–Ω—ñ—Å—Ç—é —Ä—ñ—à–µ–Ω–Ω—è –∑ –ø–æ—è—Å–Ω–µ–Ω–Ω—è–º–∏?

-------------------------------------------------

https://chatgpt.com/c/68651902-40d8-8009-a01f-a7be6ef10e84
